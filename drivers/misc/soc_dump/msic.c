/*
 * Copyright (C) 2011, Intel Corporation
 * Author: Mika Westerberg <mika.westerberg@linux.intel.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#include <linux/module.h>
#include <linux/mfd/intel_msic.h>
#include <linux/platform_device.h>

#include "socdump.h"

/*
 * Following are extracted from <linux/mfd/intel_msic.h> using a custom
 * script. Few commented out registers come from the fact that they are
 * marked as write only.
 */
static const struct {
	unsigned short	reg;
	enum chip_ids	id;
} msic_registers[] = {
	/* ID */
	{ INTEL_MSIC_ID0, MSIC_ID },
	{ INTEL_MSIC_ID1, MSIC_ID },
	/* IRQ */
	{ INTEL_MSIC_IRQLVL1, MSIC_IRQ },
	{ INTEL_MSIC_ADC1INT, MSIC_IRQ },
	{ INTEL_MSIC_CCINT, MSIC_IRQ },
	{ INTEL_MSIC_PWRSRCINT, MSIC_IRQ },
	{ INTEL_MSIC_PWRSRCINT1, MSIC_IRQ },
	{ INTEL_MSIC_CHRINT, MSIC_IRQ },
	{ INTEL_MSIC_CHRINT1, MSIC_IRQ },
	{ INTEL_MSIC_RTCIRQ, MSIC_IRQ },
	{ INTEL_MSIC_GPIO0LVIRQ, MSIC_IRQ },
	{ INTEL_MSIC_GPIO1LVIRQ, MSIC_IRQ },
	{ INTEL_MSIC_GPIOHVIRQ, MSIC_IRQ },
	{ INTEL_MSIC_VRINT, MSIC_IRQ },
	{ INTEL_MSIC_OCAUDIO, MSIC_IRQ },
	{ INTEL_MSIC_ACCDET, MSIC_IRQ },
	{ INTEL_MSIC_RESETIRQ1, MSIC_IRQ },
	{ INTEL_MSIC_RESETIRQ2, MSIC_IRQ },
	{ INTEL_MSIC_MADC1INT, MSIC_IRQ },
	{ INTEL_MSIC_MCCINT, MSIC_IRQ },
	{ INTEL_MSIC_MPWRSRCINT, MSIC_IRQ },
	{ INTEL_MSIC_MPWRSRCINT1, MSIC_IRQ },
	{ INTEL_MSIC_MCHRINT, MSIC_IRQ },
	{ INTEL_MSIC_MCHRINT1, MSIC_IRQ },
	{ INTEL_MSIC_RTCIRQMASK, MSIC_IRQ },
	{ INTEL_MSIC_GPIO0LVIRQMASK, MSIC_IRQ },
	{ INTEL_MSIC_GPIO1LVIRQMASK, MSIC_IRQ },
	{ INTEL_MSIC_GPIOHVIRQMASK, MSIC_IRQ },
	{ INTEL_MSIC_VRINTMASK, MSIC_IRQ },
	{ INTEL_MSIC_OCAUDIOMASK, MSIC_IRQ },
	{ INTEL_MSIC_ACCDETMASK, MSIC_IRQ },
	{ INTEL_MSIC_RESETIRQ1MASK, MSIC_IRQ },
	{ INTEL_MSIC_RESETIRQ2MASK, MSIC_IRQ },
	{ INTEL_MSIC_IRQLVL1MSK, MSIC_IRQ },
	{ INTEL_MSIC_PBCONFIG, MSIC_IRQ },
	{ INTEL_MSIC_PBSTATUS, MSIC_IRQ },
	/* GPIO */
	{ INTEL_MSIC_GPIO0LV7CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV6CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV5CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV4CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV3CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV2CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV1CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV0CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV7CTLOS, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV6CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV5CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV4CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV3CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV2CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV1CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV0CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV7CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV6CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV5CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV4CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV3CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV2CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV1CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0LV0CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV7CTLIS, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV6CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV5CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV4CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV3CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV2CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV1CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1LV0CTLI, MSIC_GPIO },
	{ INTEL_MSIC_PWM0CLKDIV1, MSIC_GPIO },
	{ INTEL_MSIC_PWM0CLKDIV0, MSIC_GPIO },
	{ INTEL_MSIC_PWM1CLKDIV1, MSIC_GPIO },
	{ INTEL_MSIC_PWM1CLKDIV0, MSIC_GPIO },
	{ INTEL_MSIC_PWM2CLKDIV1, MSIC_GPIO },
	{ INTEL_MSIC_PWM2CLKDIV0, MSIC_GPIO },
	{ INTEL_MSIC_PWM0DUTYCYCLE, MSIC_GPIO },
	{ INTEL_MSIC_PWM1DUTYCYCLE, MSIC_GPIO },
	{ INTEL_MSIC_PWM2DUTYCYCLE, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV3CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV2CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV1CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV0CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV3CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV2CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV1CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV0CTLO, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV3CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV2CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV1CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO0HV0CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV3CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV2CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV1CTLI, MSIC_GPIO },
	{ INTEL_MSIC_GPIO1HV0CTLI, MSIC_GPIO },
	/* SVID */
	{ INTEL_MSIC_SVIDCTRL0, MSIC_SVID },
	{ INTEL_MSIC_SVIDCTRL1, MSIC_SVID },
	{ INTEL_MSIC_SVIDCTRL2, MSIC_SVID },
	{ INTEL_MSIC_SVIDTXLASTPKT3, MSIC_SVID },
	{ INTEL_MSIC_SVIDTXLASTPKT2, MSIC_SVID },
	{ INTEL_MSIC_SVIDTXLASTPKT1, MSIC_SVID },
	{ INTEL_MSIC_SVIDTXLASTPKT0, MSIC_SVID },
	{ INTEL_MSIC_SVIDPKTOUTBYTE3, MSIC_SVID },
	{ INTEL_MSIC_SVIDPKTOUTBYTE2, MSIC_SVID },
	{ INTEL_MSIC_SVIDPKTOUTBYTE1, MSIC_SVID },
	{ INTEL_MSIC_SVIDPKTOUTBYTE0, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXVPDEBUG1, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXVPDEBUG0, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXLASTPKT3, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXLASTPKT2, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXLASTPKT1, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXLASTPKT0, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXCHKSTATUS3, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXCHKSTATUS2, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXCHKSTATUS1, MSIC_SVID },
	{ INTEL_MSIC_SVIDRXCHKSTATUS0, MSIC_SVID },
	/* VREG */
	{ INTEL_MSIC_VCCLATCH, MSIC_VREG },
	{ INTEL_MSIC_VNNLATCH, MSIC_VREG },
	{ INTEL_MSIC_VCCCNT, MSIC_VREG },
	{ INTEL_MSIC_SMPSRAMP, MSIC_VREG },
	{ INTEL_MSIC_VNNCNT, MSIC_VREG },
	{ INTEL_MSIC_VNNAONCNT, MSIC_VREG },
	{ INTEL_MSIC_VCC122AONCNT, MSIC_VREG },
	{ INTEL_MSIC_V180AONCNT, MSIC_VREG },
	{ INTEL_MSIC_V500CNT, MSIC_VREG },
	{ INTEL_MSIC_VIHFCNT, MSIC_VREG },
	{ INTEL_MSIC_LDORAMP1, MSIC_VREG },
	{ INTEL_MSIC_LDORAMP2, MSIC_VREG },
	{ INTEL_MSIC_VCC108AONCNT, MSIC_VREG },
	{ INTEL_MSIC_VCC108ASCNT, MSIC_VREG },
	{ INTEL_MSIC_VCC108CNT, MSIC_VREG },
	{ INTEL_MSIC_VCCA100ASCNT, MSIC_VREG },
	{ INTEL_MSIC_VCCA100CNT, MSIC_VREG },
	{ INTEL_MSIC_VCC180AONCNT, MSIC_VREG },
	{ INTEL_MSIC_VCC180CNT, MSIC_VREG },
	{ INTEL_MSIC_VCC330CNT, MSIC_VREG },
	{ INTEL_MSIC_VUSB330CNT, MSIC_VREG },
	{ INTEL_MSIC_VCCSDIOCNT, MSIC_VREG },
	{ INTEL_MSIC_VPROG1CNT, MSIC_VREG },
	{ INTEL_MSIC_VPROG2CNT, MSIC_VREG },
	{ INTEL_MSIC_VEMMCSCNT, MSIC_VREG },
	{ INTEL_MSIC_VEMMC1CNT, MSIC_VREG },
	{ INTEL_MSIC_VEMMC2CNT, MSIC_VREG },
	{ INTEL_MSIC_VAUDACNT, MSIC_VREG },
	{ INTEL_MSIC_VHSPCNT, MSIC_VREG },
	{ INTEL_MSIC_VHSNCNT, MSIC_VREG },
	{ INTEL_MSIC_VHDMICNT, MSIC_VREG },
	{ INTEL_MSIC_VOTGCNT, MSIC_VREG },
	{ INTEL_MSIC_V1P35CNT, MSIC_VREG },
	{ INTEL_MSIC_V330AONCNT, MSIC_VREG },
	/* RESET */
	/* { INTEL_MSIC_CHIPCNTRL, MSIC_RESET }, */
	{ INTEL_MSIC_ERCONFIG, MSIC_RESET },
	/* BURST */
	{ INTEL_MSIC_BATCURRENTLIMIT12, MSIC_BURST },
	{ INTEL_MSIC_BATTIMELIMIT12, MSIC_BURST },
	{ INTEL_MSIC_BATTIMELIMIT3, MSIC_BURST },
	{ INTEL_MSIC_BATTIMEDB, MSIC_BURST },
	{ INTEL_MSIC_BRSTCONFIGOUTPUTS, MSIC_BURST },
	{ INTEL_MSIC_BRSTCONFIGACTIONS, MSIC_BURST },
	{ INTEL_MSIC_BURSTCONTROLSTATUS, MSIC_BURST },
	/* RTC */
	{ INTEL_MSIC_RTCB1, MSIC_RTC },
	{ INTEL_MSIC_RTCB2, MSIC_RTC },
	{ INTEL_MSIC_RTCB3, MSIC_RTC },
	{ INTEL_MSIC_RTCB4, MSIC_RTC },
	{ INTEL_MSIC_RTCOB1, MSIC_RTC },
	{ INTEL_MSIC_RTCOB2, MSIC_RTC },
	{ INTEL_MSIC_RTCOB3, MSIC_RTC },
	{ INTEL_MSIC_RTCOB4, MSIC_RTC },
	{ INTEL_MSIC_RTCAB1, MSIC_RTC },
	{ INTEL_MSIC_RTCAB2, MSIC_RTC },
	{ INTEL_MSIC_RTCAB3, MSIC_RTC },
	{ INTEL_MSIC_RTCAB4, MSIC_RTC },
	{ INTEL_MSIC_RTCWAB1, MSIC_RTC },
	{ INTEL_MSIC_RTCWAB2, MSIC_RTC },
	{ INTEL_MSIC_RTCWAB3, MSIC_RTC },
	{ INTEL_MSIC_RTCWAB4, MSIC_RTC },
	{ INTEL_MSIC_RTCSC1, MSIC_RTC },
	{ INTEL_MSIC_RTCSC2, MSIC_RTC },
	{ INTEL_MSIC_RTCSC3, MSIC_RTC },
	{ INTEL_MSIC_RTCSC4, MSIC_RTC },
	{ INTEL_MSIC_RTCSTATUS, MSIC_RTC },
	{ INTEL_MSIC_RTCCONFIG1, MSIC_RTC },
	{ INTEL_MSIC_RTCCONFIG2, MSIC_RTC },
	/* CHARGER */
	{ INTEL_MSIC_BDTIMER, MSIC_CHARGER },
	{ INTEL_MSIC_BATTRMV, MSIC_CHARGER },
	{ INTEL_MSIC_VBUSDET, MSIC_CHARGER },
	{ INTEL_MSIC_VBUSDET1, MSIC_CHARGER },
	{ INTEL_MSIC_ADPHVDET, MSIC_CHARGER },
	{ INTEL_MSIC_ADPLVDET, MSIC_CHARGER },
	{ INTEL_MSIC_ADPDETDBDM, MSIC_CHARGER },
	{ INTEL_MSIC_LOWBATTDET, MSIC_CHARGER },
	{ INTEL_MSIC_CHRCTRL, MSIC_CHARGER },
	{ INTEL_MSIC_CHRCVOLTAGE, MSIC_CHARGER },
	{ INTEL_MSIC_CHRCCURRENT, MSIC_CHARGER },
	{ INTEL_MSIC_SPCHARGER, MSIC_CHARGER },
	{ INTEL_MSIC_CHRTTIME, MSIC_CHARGER },
	{ INTEL_MSIC_CHRCTRL1, MSIC_CHARGER },
	{ INTEL_MSIC_PWRSRCLMT, MSIC_CHARGER },
	{ INTEL_MSIC_CHRSTWDT, MSIC_CHARGER },
	/* { INTEL_MSIC_WDTWRITE, MSIC_CHARGER }, */
	{ INTEL_MSIC_CHRSAFELMT, MSIC_CHARGER },
	{ INTEL_MSIC_SPWRSRCINT, MSIC_CHARGER },
	{ INTEL_MSIC_SPWRSRCINT1, MSIC_CHARGER },
	{ INTEL_MSIC_CHRLEDPWM, MSIC_CHARGER },
	{ INTEL_MSIC_CHRLEDCTRL, MSIC_CHARGER },
	/* ADC */
	{ INTEL_MSIC_ADC1CNTL1, MSIC_ADC },
	{ INTEL_MSIC_ADC1CNTL2, MSIC_ADC },
	{ INTEL_MSIC_ADC1CNTL3, MSIC_ADC },
	{ INTEL_MSIC_ADC1OFFSETH, MSIC_ADC },
	{ INTEL_MSIC_ADC1OFFSETL, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR0, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR1, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR2, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR3, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR4, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR5, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR6, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR7, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR8, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR9, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR10, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR11, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR12, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR13, MSIC_ADC },
	{ INTEL_MSIC_ADC1ADDR14, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS0H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS0L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS1H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS1L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS2H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS2L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS3H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS3L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS4H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS4L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS5H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS5L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS6H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS6L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS7H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS7L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS8H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS8L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS9H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS9L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS10H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS10L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS11H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS11L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS12H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS12L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS13H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS13L, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS14H, MSIC_ADC },
	{ INTEL_MSIC_ADC1SNS14L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV0H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV0L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV1H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV1L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV2H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV2L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV3H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BV3L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI0H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI0L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI1H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI1L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI2H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI2L, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI3H, MSIC_ADC },
	{ INTEL_MSIC_ADC1BI3L, MSIC_ADC },
	{ INTEL_MSIC_CCCNTL, MSIC_ADC },
	{ INTEL_MSIC_CCOFFSETH, MSIC_ADC },
	{ INTEL_MSIC_CCOFFSETL, MSIC_ADC },
	{ INTEL_MSIC_CCADCHA, MSIC_ADC },
	{ INTEL_MSIC_CCADCLA, MSIC_ADC },
	/* AUDIO */
	{ INTEL_MSIC_AUDPLLCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_DMICBUF0123, MSIC_AUDIO },
	{ INTEL_MSIC_DMICBUF45, MSIC_AUDIO },
	{ INTEL_MSIC_DMICGPO, MSIC_AUDIO },
	{ INTEL_MSIC_DMICMUX, MSIC_AUDIO },
	{ INTEL_MSIC_DMICCLK, MSIC_AUDIO },
	{ INTEL_MSIC_MICBIAS, MSIC_AUDIO },
	{ INTEL_MSIC_ADCCONFIG, MSIC_AUDIO },
	{ INTEL_MSIC_MICAMP1, MSIC_AUDIO },
	{ INTEL_MSIC_MICAMP2, MSIC_AUDIO },
	{ INTEL_MSIC_NOISEMUX, MSIC_AUDIO },
	{ INTEL_MSIC_AUDIOMUX12, MSIC_AUDIO },
	{ INTEL_MSIC_AUDIOMUX34, MSIC_AUDIO },
	{ INTEL_MSIC_AUDIOSINC, MSIC_AUDIO },
	{ INTEL_MSIC_AUDIOTXEN, MSIC_AUDIO },
	{ INTEL_MSIC_HSEPRXCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_IHFRXCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_VOICETXVOL, MSIC_AUDIO },
	{ INTEL_MSIC_SIDETONEVOL, MSIC_AUDIO },
	{ INTEL_MSIC_MUSICSHARVOL, MSIC_AUDIO },
	{ INTEL_MSIC_VOICETXCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_HSMIXER, MSIC_AUDIO },
	{ INTEL_MSIC_DACCONFIG, MSIC_AUDIO },
	{ INTEL_MSIC_SOFTMUTE, MSIC_AUDIO },
	{ INTEL_MSIC_HSLVOLCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_HSRVOLCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_IHFLVOLCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_IHFRVOLCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_DRIVEREN, MSIC_AUDIO },
	{ INTEL_MSIC_LINEOUTCTRL, MSIC_AUDIO },
	{ INTEL_MSIC_VIB1CTRL1, MSIC_AUDIO },
	{ INTEL_MSIC_VIB1CTRL2, MSIC_AUDIO },
	{ INTEL_MSIC_VIB1CTRL3, MSIC_AUDIO },
	{ INTEL_MSIC_VIB1SPIPCM_1, MSIC_AUDIO },
	{ INTEL_MSIC_VIB1SPIPCM_2, MSIC_AUDIO },
	{ INTEL_MSIC_VIB1CTRL5, MSIC_AUDIO },
	{ INTEL_MSIC_VIB2CTRL1, MSIC_AUDIO },
	{ INTEL_MSIC_VIB2CTRL2, MSIC_AUDIO },
	{ INTEL_MSIC_VIB2CTRL3, MSIC_AUDIO },
	{ INTEL_MSIC_VIB2SPIPCM_1, MSIC_AUDIO },
	{ INTEL_MSIC_VIB2SPIPCM_2, MSIC_AUDIO },
	{ INTEL_MSIC_VIB2CTRL5, MSIC_AUDIO },
	{ INTEL_MSIC_BTNCTRL1, MSIC_AUDIO },
	{ INTEL_MSIC_BTNCTRL2, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1TXSLOT01, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1TXSLOT23, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1TXSLOT45, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1RXSLOT0123, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1RXSLOT045, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2TXSLOT01, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2TXSLOT23, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2TXSLOT45, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2RXSLOT01, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2RXSLOT23, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2RXSLOT45, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1CTRL1, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1CTRL2, MSIC_AUDIO },
	{ INTEL_MSIC_PCM1CTRL3, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2CTRL1, MSIC_AUDIO },
	{ INTEL_MSIC_PCM2CTRL2, MSIC_AUDIO },
	/* HDMI */
	{ INTEL_MSIC_HDMIPUEN, MSIC_HDMI },
	{ INTEL_MSIC_HDMISTATUS, MSIC_HDMI },
};

static void msic_dump_regs(void *buf)
{
	struct reg_info *ri = buf;
	int i;

	for (i = 0; i < ARRAY_SIZE(msic_registers); i++, ri++) {
		unsigned short reg = msic_registers[i].reg;
		u8 val;

		if (intel_msic_reg_read(reg, &val) == 0) {
			ri->valid = 1;
			ri->register_value = val;
		} else {
			ri->valid = 0;
			ri->register_value = 0;
		}

		ri->version = INFO_VER;
		ri->chip_id = msic_registers[i].id;
		ri->register_id = reg;
	}
}

static int __devinit msic_dump_probe(struct platform_device *pdev)
{
	struct dump_source *ds;

	ds = dump_source_create();
	if (!ds)
		return -ENOMEM;

	ds->dump_regs = msic_dump_regs;
	ds->count = ARRAY_SIZE(msic_registers);
	platform_set_drvdata(pdev, ds);

	dump_source_add(ds);
	return 0;
}

static int __devexit msic_dump_remove(struct platform_device *pdev)
{
	struct dump_source *ds = platform_get_drvdata(pdev);

	platform_set_drvdata(pdev, NULL);
	dump_source_remove(ds);
	dump_source_destroy(ds);

	return 0;
}

static struct platform_driver msic_dump_driver = {
	.probe		= msic_dump_probe,
	.remove		= __devexit_p(msic_dump_remove),
	.driver		= {
		.name	= "msic_dump",
		.owner	= THIS_MODULE,
	},
};

static int __init msic_dump_init(void)
{
	return platform_driver_register(&msic_dump_driver);
}
module_init(msic_dump_init);

static void __exit msic_dump_exit(void)
{
	platform_driver_unregister(&msic_dump_driver);
}
module_exit(msic_dump_exit);

MODULE_DESCRIPTION("MSIC SoC Dump driver");
MODULE_AUTHOR("Mika Westerberg <mika.westerberg@linux.intel.com>");
MODULE_LICENSE("GPL");
